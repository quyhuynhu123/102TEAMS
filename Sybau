local player = game.Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Name = "EggMenu"
gui.Parent = PlayerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 400, 0, 250)
mainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = gui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 15)

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1,0,0,30)
titleBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
titleBar.Parent = mainFrame
Instance.new("UICorner", titleBar).CornerRadius = UDim.new(0, 10)

local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1,-60,1,0)
titleText.Position = UDim2.new(0,10,0,0)
titleText.BackgroundTransparency = 1
titleText.Font = Enum.Font.GothamBold
titleText.Text = "üê£ Egg Menu"
titleText.TextSize = 18
titleText.TextColor3 = Color3.fromRGB(255,255,255)
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Parent = titleBar

-- Minimize Button (-)
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0,30,0,30)
minimizeBtn.Position = UDim2.new(1,-60,0,0)
minimizeBtn.Text = "-"
minimizeBtn.TextSize = 24
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)
minimizeBtn.Parent = titleBar
Instance.new("UICorner", minimizeBtn).CornerRadius = UDim.new(1,0)

-- Close Button (X)
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0,30,0,30)
closeBtn.Position = UDim2.new(1,-30,0,0)
closeBtn.Text = "X"
closeBtn.TextSize = 20
closeBtn.Font = Enum.Font.GothamBold
closeBtn.BackgroundColor3 = Color3.fromRGB(150,0,0)
closeBtn.Parent = titleBar
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1,0)

-- Content Frame
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1,0,1,-30)
contentFrame.Position = UDim2.new(0,0,0,30)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Create button helper
local function createButton(name, yPos)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 350, 0, 50)
    btn.Position = UDim2.new(0.5, -175, 0, yPos)
    btn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 22
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Text = name
    btn.Parent = contentFrame
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)
    return btn
end

local btn1 = createButton("üì¶ Step 1: Download Resource", 10)
local btn2 = createButton("üé≤ Step 2: Random Egg", 70)
local btn3 = createButton("üåÄ Step 3: Dupe Pet", 130)

-- Toggle Button (always visible)
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 60, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0.8, 0)
toggleBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 200)
toggleBtn.Text = "üìú"
toggleBtn.TextSize = 24
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
toggleBtn.Parent = gui
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0,10)

-- ‚úÖ Make toggle button draggable
toggleBtn.Active = true
toggleBtn.Draggable = true

-- States
local downloading = false
local downloaded = false

-- Warning
local function warnAlert(msg)
    game.StarterGui:SetCore("SendNotification",{
        Title="‚ö†Ô∏è Warning",
        Text=msg,
        Duration=3
    })
end

-- Step 1: Download
btn1.MouseButton1Click:Connect(function()
    if downloading or downloaded then return end
    downloading = true
    btn1.Text = "üì¶ Downloading... 0%"
    local totalTime = 180 -- 3 minutes
    local elapsed = 0
    while elapsed < totalTime do
        task.wait(1)
        elapsed += 1
        local percent = math.floor((elapsed/totalTime)*100)
        btn1.Text = "üì¶ Downloading... "..percent.."%"
    end
    downloading = false
    downloaded = true
    btn1.Text = "‚úÖ Download Complete!"
end)

-- Step 2: Random Egg
btn2.MouseButton1Click:Connect(function()
    if not downloaded then
        warnAlert("You must complete Step 1 first!")
        return
    end
    print("üé≤ Random Egg Activated!")
    -- Put your Random Egg code here
end)

-- Step 3: Dupe Pet
btn3.MouseButton1Click:Connect(function()
    if not downloaded then
        warnAlert("You must complete Step 1 first!")
        return
    end
    print("üåÄ Dupe Pet Activated!")
    -- Put your Dupe Pet code here
end)

-- Minimize
minimizeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
end)

-- Toggle open/close
toggleBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)

-- Close
closeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
end)
